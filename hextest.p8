pico-8 cartridge // http://www.pico-8.com
version 33
__lua__
function _init()
	poke(0x5f2d, 1)
	log("kurwa",true)

	
	hexes={}
	cam_x,cam_y=0,0
	mx,my=0,0
	
	--hex array in axial coordinates
	for q=0,20 do
		for r=0,10 do
		 add(hexes,{q=q,r=r})
		end
	end
end

function round(val)
	return flr(val+.5)
end

function h2p(hex)
	local x = hex.q*12
	local y = hex.r*14+hex.q*7
	return {x=x,y=y}
end

function p2h(p)
	local q=p.x/12
	local r=p.y/14-q/2
	
	log("q  "..q)
	log("r  "..r)
	
	if q%1>.4 and q%1<.55 then
		return nil
	end
	
	return {q=round(q),r=round(r)}
end

function _update60()
 if btn(➡️) then
 	cam_x+=1
 end
 if btn(⬅️) then
 	cam_x-=1
 end
 if btn(⬆️) then
 	cam_y-=1
 end
 if btn(⬇️) then
 	cam_y+=1
 end
 
 mx,my=stat(32),stat(33)
 cmx,cmy=cam_x+mx,cam_y+my
 hexp=p2h({x=cmx,y=cmy})
end

function _draw()
	cls(12)
	
	--hex grid
	camera(cam_x,cam_y)
	for h in all(hexes) do
		local p=h2p(h)
 	spr(1,p.x-7,p.y-7,2,2)
  --pset(p.x,p.y,8)
	end
	
	if(pget(cmx,cmy)!=12) then
		if(hexp) then
			local shp=h2p(hexp)
			spr(3+flr(sin(t()*2)+1)*2,shp.x-7,shp.y-7,2,2)
		end
	end
	camera()
	
	spr(15,mx,my)
	--debug
	--print(cam_x,120,5,1)
	--print(cam_y,120,11,1)
	--print(mx,5,5,1)
	--print(my,5,11,1)
	--print(cmx,105,5,1)
	--print(cmy,105,11,1)
	--print(round(hexp.q-0.01),60,5,1)
--	print(hexp.q,70,5,1)
	--print(round(hexp.r),60,11,1)
	--print(hexp.r,70,11,1)
end
-->8
function log(t,over)
	printh(t,"log",over or false)
end

__gfx__
0000000000033333333330000003388338833000000883388338800000000000000000000000000000000000000000000000000000000000af00000001000000
000000000003bbbbbbbb30000008bbbbbbbb80000003bbbbbbbb300000000000000000000000000000000000000000000000000000000000f800000017100000
00700700003bbbbbbbbbb300008bbbbbbbbbb800008bbbbbbbbbb800000000000000000000000000000000000000000000000000000000000080000017710000
00077000003bbbbbbbbbb300003bbbbbbbbbb300008bbbbbbbbbb800000000000000000000000000000000000000000000000000000000000008000017771000
0007700003bbbbbbbbbbbb3003bbbbbbbbbbbb3003bbbbbbbbbbbb30000000000000000000000000000000000000000000000000000000000000000017777100
0070070003bbbbbbbbbbbb3008bbbbbbbbbbbb8003bbbbbbbbbbbb30000000000000000000000000000000000000000000000000000000000000000017711000
000000003bbbbbbbbbbbbbb38bbbbbbbbbbbbbb88bbbbbbbbbbbbbb8000000000000000000000000000000000000000000000000000000000000000001171000
000000003bbbbbbbbbbbbbb33bbbbbbbbbbbbbb38bbbbbbbbbbbbbb8000000000000000000000000000000000000000000000000000000000000000000000000
000000003bbbbbbbbbbbbbb38bbbbbbbbbbbbbb88bbbbbbbbbbbbbb8000000000000000000000000000000000000000000000000000000000000000000000000
0000000003bbbbbbbbbbbb3008bbbbbbbbbbbb8003bbbbbbbbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000
0000000003bbbbbbbbbbbb3003bbbbbbbbbbbb3003bbbbbbbbbbbb30000000000000000000000000000000000000000000000000000000000000000000000000
00000000003bbbbbbbbbb300003bbbbbbbbbb300008bbbbbbbbbb800000000000000000000000000000000000000000000000000000000000000000000000000
00000000003bbbbbbbbbb300008bbbbbbbbbb800008bbbbbbbbbb800000000000000000000000000000000000000000000000000000000000000000000000000
000000000003bbbbbbbb30000008bbbbbbbb80000003bbbbbbbb3000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000333333333300000033883388330000008833883388000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000a0033333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000038b8b8b8b30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000a03ab8b8b8b8a3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000003a8b8b8b8ba3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000a3bab8b8b8b8a8300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000038a8b8b8b8bab300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000a8bab8b8b8b8a8b30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000002b2a2b228b8bab830000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000038bab8b8b8b8a8b30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000038a8b8b8b8bab300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000003bab8b8b8b8a8300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000003a8b8b8b8ba3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000003ab8b8b8b8a3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000038b8b8b8b30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000033333333330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
